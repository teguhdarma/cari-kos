{"version":3,"sources":["../../src/components/Uploader.js"],"names":["ctrlKey","cmdKey","propTypes","hasFocus","PropTypes","bool","onFocus","func","onBlur","onBrowse","isRequired","onSetupButtonClicked","onUploadComplete","secrets","shape","token","string","secretKey","enableSignedUrls","buttons","node","children","createEventHandler","events$","Subject","handler","event","next","asObservable","MuxVideoInputUploader","Component","isDraggingOver","invalidPaste","invalidFile","uploadProgress","fileInfo","uuid","React","createRef","evt","percent","setState","file","upload","props","pipe","onCancelUploadButtonClick$","state","client","delete","subscribe","complete","error","handleUploadEvent","err","type","handleUploadSuccess","asset","handleProgress","url","assetDocument","clipboardData","window","getData","options","sEvent","message","toLowerCase","match","setTimeout","preventDefault","stopPropagation","nativeEvent","dataTransfer","then","files","handleUploadFile","dragEnteredEls","push","target","idx","indexOf","splice","length","container","current","focus","handleErrorClose","keyCode","ctrlDown","vKey","hiddenTextField","componentWillUnmount","unSubscribeToUpload","componentDidMount","onClick$","onClick","handleCancelUploadButtonClick","closed","unsubscribe","renderUploadPlaceHolder","renderUploadProgress","text","name","styles","progressBar","cancelUploadButton","renderError","handleSetupButtonClicked","renderButtons","renderChildren","render","handleDrop","handleKeyDown","handleDragOver","handleDragLeave","handleDragEnter","handlePaste","defaultProps"],"mappings":"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","sourcesContent":["import {UploadIcon} from '@sanity/icons'\nimport {Button, Card, Grid} from '@sanity/ui'\nimport ButtonCollection from 'part:@sanity/components/buttons/button-collection'\nimport DialogContent from 'part:@sanity/components/dialogs/content'\nimport Dialog from 'part:@sanity/components/dialogs/default'\nimport FormField from 'part:@sanity/components/formfields/default'\nimport ProgressBar from 'part:@sanity/components/progress/bar'\nimport PropTypes from 'prop-types'\nimport React, {Component} from 'react'\nimport {FiUpload} from 'react-icons/fi'\nimport {Subject} from 'rxjs'\nimport {takeUntil, tap} from 'rxjs/operators'\nimport {uploadFile, uploadUrl} from '../actions/upload'\nimport client from '../clients/SanityClient'\nimport {extractDroppedFiles} from '../util/extractFiles'\nimport FileInputButton from './FileInputButton'\nimport styles from './Uploader.css'\nimport UploadPlaceholder from './UploadPlaceholder'\n\nconst ctrlKey = 17\nconst cmdKey = 91\n\nconst propTypes = {\n  hasFocus: PropTypes.bool,\n  onFocus: PropTypes.func,\n  onBlur: PropTypes.func,\n  onBrowse: PropTypes.func.isRequired,\n  onSetupButtonClicked: PropTypes.func.isRequired,\n  onUploadComplete: PropTypes.func,\n  secrets: PropTypes.shape({\n    token: PropTypes.string,\n    secretKey: PropTypes.string,\n    enableSignedUrls: PropTypes.bool,\n  }),\n  buttons: PropTypes.node,\n  children: PropTypes.node,\n}\n\nfunction createEventHandler() {\n  const events$ = new Subject()\n  const handler = (event) => events$.next(event)\n  return [events$.asObservable(), handler]\n}\n\nclass MuxVideoInputUploader extends Component {\n  state = {\n    isDraggingOver: false,\n    invalidPaste: false,\n    invalidFile: false,\n    uploadProgress: null,\n    fileInfo: null,\n    uuid: null,\n  }\n  dragEnteredEls = []\n\n  upload = null\n\n  ctrlDown = false\n\n  cancelUploadButton = React.createRef()\n  hiddenTextField = React.createRef()\n  container = React.createRef()\n\n  componentWillUnmount() {\n    this.unSubscribeToUpload()\n  }\n\n  componentDidMount() {\n    const [onClick$, onClick] = createEventHandler()\n    this.onCancelUploadButtonClick$ = onClick$\n    this.handleCancelUploadButtonClick = onClick\n  }\n\n  unSubscribeToUpload() {\n    if (this.upload && !this.upload.closed) {\n      this.upload.unsubscribe()\n    }\n  }\n\n  handleProgress = (evt) => {\n    if (evt.percent) {\n      this.setState({uploadProgress: evt.percent})\n    }\n    if (evt.file) {\n      this.setState({fileInfo: evt.file})\n    }\n  }\n\n  handleUploadFile = (file) => {\n    this.setState({uploadProgress: 0, fileInfo: null, uuid: null})\n    this.upload = uploadFile(file, {enableSignedUrls: this.props.secrets.enableSignedUrls})\n      .pipe(\n        takeUntil(\n          this.onCancelUploadButtonClick$.pipe(\n            tap(() => {\n              if (this.state.uuid) {\n                client.delete(this.state.uuid)\n              }\n            })\n          )\n        )\n      )\n      .subscribe({\n        complete: () => {\n          this.setState({error: null, uploadProgress: null, uuid: null})\n        },\n        next: (event) => {\n          this.handleUploadEvent(event)\n        },\n        error: (err) => {\n          this.setState({error: err, uploadProgress: null, uuid: null})\n        },\n      })\n  }\n\n  handleUploadEvent = (event) => {\n    switch (event.type) {\n      case 'success':\n        return this.handleUploadSuccess(event.asset)\n      case 'progress':\n        return this.handleProgress(event)\n      case 'file':\n        return this.setState({fileInfo: event.file})\n      case 'uuid':\n        // Means we created a mux.videoAsset document with an uuid\n        return this.setState({uuid: event.uuid})\n      case 'url':\n        return this.setState({url: event.url, uploadProgress: 100})\n      default:\n        return null\n    }\n  }\n\n  handleUploadSuccess = (assetDocument) => {\n    this.setState({uploadProgress: 100})\n    if (this.props.onUploadComplete) {\n      this.props.onUploadComplete(assetDocument)\n    }\n  }\n\n  handlePaste = (event) => {\n    const clipboardData = event.clipboardData || window.clipboardData\n    const url = clipboardData.getData('text')\n    const options = {enableSignedUrls: this.props.secrets.enableSignedUrls}\n\n    this.upload = uploadUrl(url, options).subscribe({\n      complete: () => {\n        this.setState({error: null, uploadProgress: null, url: null})\n      },\n      next: (sEvent) => {\n        this.handleUploadEvent(sEvent)\n      },\n      error: (err) => {\n        let error\n        // Don't output error dialog when just invalid url\n        if (!err.message.toLowerCase().match('invalid url')) {\n          error = err\n        }\n        this.setState({invalidPaste: true, error}, () => {\n          setTimeout(() => {\n            this.setState({invalidPaste: false, uploadProgress: null})\n          }, 2000)\n        })\n      },\n    })\n  }\n\n  handleDrop = (event) => {\n    this.setState({isDraggingOver: false})\n    event.preventDefault()\n    event.stopPropagation()\n    extractDroppedFiles(event.nativeEvent.dataTransfer).then((files) => {\n      if (files) {\n        this.handleUploadFile(files[0])\n      }\n    })\n  }\n\n  handleDragOver = (event) => {\n    event.preventDefault()\n    event.stopPropagation()\n  }\n\n  handleDragEnter = (event) => {\n    event.stopPropagation()\n    this.dragEnteredEls.push(event.target)\n    this.setState({isDraggingOver: true})\n  }\n\n  handleDragLeave = (event) => {\n    event.stopPropagation()\n    const idx = this.dragEnteredEls.indexOf(event.target)\n    if (idx > -1) {\n      this.dragEnteredEls.splice(idx, 1)\n    }\n    if (this.dragEnteredEls.length === 0) {\n      this.setState({isDraggingOver: false})\n    }\n  }\n\n  handleCancelUploadButtonClicked = (event) => {\n    this.setState({uploadProgress: null, error: null})\n    this.container.current.focus()\n  }\n\n  handleErrorClose = (event) => {\n    if (event) {\n      event.preventDefault()\n    }\n    if (this.state.uploadProgress !== null) {\n      return\n    }\n    this.setState({\n      invalidFile: false,\n      invalidPaste: false,\n      error: null,\n      uploadProgress: null,\n    })\n    this.container.current.focus()\n  }\n\n  handleSetupButtonClicked = (event) => {\n    this.handleErrorClose(event)\n    this.props.onSetupButtonClicked()\n  }\n\n  renderUploadPlaceHolder() {\n    if (this.props.children) {\n      return null\n    }\n    if (this.state.uploadProgress !== null) {\n      return null\n    }\n    const {invalidFile, invalidPaste, isDraggingOver} = this.state\n    return (\n      <div>\n        <FormField level={0}>\n          <UploadPlaceholder\n            isDraggingOver={isDraggingOver}\n            hasFocus={this.props.hasFocus}\n            invalidPaste={invalidPaste}\n            invalidFile={invalidFile}\n          />\n        </FormField>\n        <ButtonCollection>\n          <FileInputButton\n            icon={<FiUpload data-sanity-icon=\"upload\" />}\n            onSelect={(files) => this.handleUploadFile(files[0])}\n            accept={'video/*'}\n            text=\"Upload\"\n          />\n          <Button mode=\"ghost\" tone=\"default\" text=\"Browse\" onClick={this.props.onBrowse} />\n        </ButtonCollection>\n      </div>\n    )\n  }\n\n  // eslint-disable-next-line complexity\n  renderUploadProgress() {\n    const {uploadProgress, fileInfo, url} = this.state\n    if (uploadProgress === null) {\n      return null\n    }\n    let text =\n      uploadProgress < 100\n        ? `Uploading ${fileInfo ? `'${fileInfo.name}'` : 'file'}`\n        : 'Waiting for Mux to complete the file'\n    if (this.state.error) {\n      text = this.state.error.message\n    }\n    if (url) {\n      text = `Uploading ${url}`\n    }\n    return (\n      <div className={styles.uploadProgress}>\n        <div className={styles.progressBar}>\n          <ProgressBar\n            percent={uploadProgress}\n            text={text}\n            isInProgress={uploadProgress === 100 && !this.state.error}\n            showPercent\n            animation\n            color=\"primary\"\n          />\n        </div>\n        {(uploadProgress < 100 || this.state.error) && (\n          <div ref={this.cancelUploadButton}>\n            <Button\n              text=\"Cancel upload\"\n              padding={3}\n              tone=\"critical\"\n              onClick={this.handleCancelUploadButtonClick}\n            />\n          </div>\n        )}\n      </div>\n    )\n  }\n\n  renderError() {\n    const {uploadProgress, error} = this.state\n    if (!error) {\n      return null\n    }\n    if (uploadProgress !== null) {\n      return null\n    }\n    let message = this.state.error.message\n    if (message === 'Invalid credentials') {\n      message = (\n        <div>\n          <h3>Invalid credentials</h3>\n          <p>You need to check your Mux access token and secret key.</p>\n          <Button\n            text=\"Run setup\"\n            tone=\"primary\"\n            padding={3}\n            onClick={this.handleSetupButtonClicked}\n          />\n        </div>\n      )\n    }\n    return (\n      <Dialog\n        title=\"Upload failed\"\n        color=\"danger\"\n        useOverlay\n        onClose={this.handleErrorClose}\n        onEscape={this.handleErrorClose}\n        onClickOutside={this.handleErrorClose}\n      >\n        <DialogContent size=\"small\">{message}</DialogContent>\n      </Dialog>\n    )\n  }\n\n  renderButtons() {\n    if (this.state.uploadProgress === null && this.props.buttons) {\n      return (\n        <Grid columns={4} gap={2}>\n          <FileInputButton\n            icon={<UploadIcon data-sanity-icon=\"upload\" />}\n            onSelect={(files) => this.handleUploadFile(files[0])}\n            text=\"Upload\"\n          />\n          {this.props.buttons}\n        </Grid>\n      )\n    }\n    return null\n  }\n\n  renderChildren() {\n    if (this.state.uploadProgress !== null) {\n      return null\n    }\n    return this.props.children\n  }\n\n  handleKeyDown = (event) => {\n    if (event.keyCode == ctrlKey || event.keyCode == cmdKey) {\n      this.ctrlDown = true\n    }\n    const vKey = 86\n    if (this.ctrlDown && event.keyCode == vKey) {\n      this.hiddenTextField.current.focus()\n    }\n  }\n\n  handleKeyUp = (event) => {\n    if (event.keyCode == ctrlKey || event.keyCode == cmdKey) {\n      this.ctrlDown = false\n    }\n  }\n\n  handleFocus = (event) => {\n    this.props.onFocus(event)\n  }\n\n  render() {\n    return (\n      <Card\n        padding={0}\n        radius={0}\n        shadow={0}\n        tabIndex={0}\n        onBlur={this.props.onBlur}\n        onFocus={this.props.onFocus}\n        onDrop={this.handleDrop}\n        onKeyDown={this.handleKeyDown}\n        onDragOver={this.handleDragOver}\n        onDragLeave={this.handleDragLeave}\n        onDragEnter={this.handleDragEnter}\n        ref={this.container}\n      >\n        <input\n          ref={this.hiddenTextField}\n          className={styles.hiddenTextField}\n          type=\"text\"\n          onPaste={this.handlePaste}\n        />\n        {this.renderError()}\n        {this.renderUploadProgress()}\n        {this.renderUploadPlaceHolder()}\n        {this.renderChildren()}\n        {this.renderButtons()}\n      </Card>\n    )\n  }\n}\n\nMuxVideoInputUploader.propTypes = propTypes\n\nMuxVideoInputUploader.defaultProps = {\n  hasFocus: false,\n  onFocus: null,\n  onBlur: null,\n  onUploadComplete: null,\n  secrets: {\n    token: '',\n    secretKey: '',\n    enableSignedUrls: false,\n  },\n  buttons: null,\n  children: null,\n}\n\nexport default MuxVideoInputUploader\n"],"file":"Uploader.js"}